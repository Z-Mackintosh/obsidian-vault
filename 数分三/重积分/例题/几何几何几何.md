# 例题
$$ \text{求球面 }x^2+y^2+z^2=R^2\text{和圆柱面 }x^2+y^2=Rx(R>0)\text{所围立体的体积}.$$

# 解答

### 1. 理解几何体与对称性

首先，我们需要分析构成这个立体的两个曲面：
*   **球面**: $x^2 + y^2 + z^2 = R^2$
    这是一个以原点 $(0,0,0)$ 为中心，半径为 $R$ 的球面。
*   **圆柱面**: $x^2 + y^2 = Rx$
    我们可以通过配方来理解这个圆柱面。方程可以改写为 $x^2 - Rx + y^2 = 0$，配方后得到 $(x - \frac{R}{2})^2 + y^2 = (\frac{R}{2})^2$。
    这是一个沿着 $z$ 轴方向的圆柱面，其在 $xy$ 平面上的投影（准线）是一个圆心在 $(\frac{R}{2}, 0)$，半径为 $\frac{R}{2}$ 的圆。

这个立体是球面被圆柱面“挖掉”或“切割”出的部分。

**利用对称性是解题的第一步，也是至关重要的一步**：
*   **关于 $xy$ 平面的对称性**：球面的方程中 $z$ 是以 $z^2$ 形式出现，所以球面关于 $xy$ 平面 ($z=0$) 是对称的。圆柱面不依赖于 $z$，自然也关于 $xy$ 平面对称。因此，整个立体关于 $xy$ 平面对称。我们可以只计算 $z \ge 0$ 部分（上半部分）的体积，然后乘以 2。
*   **关于 $xz$ 平面的对称性**：球面的方程中 $y$ 是以 $y^2$ 形式出现，圆柱面的方程中 $y$ 也是以 $y^2$ 形式出现，所以整个立体关于 $xz$ 平面 ($y=0$) 也是对称的。我们可以只计算 $y \ge 0$ 部分的体积，再乘以 2。

综合利用这两个对称性，我们可以只计算在第一卦限内（$x \ge 0, y \ge 0, z \ge 0$）的体积，最后将结果乘以 4。

### 2. 建立体积的二重积分表达式

根据对称性，总体积 $V$ 可以表示为：
$$ V = 2 \iint_D z(x, y) \,dx\,dy $$
其中 $D$ 是立体在 $xy$ 平面上的投影区域，而 $z(x, y)$ 是立体的上表面方程。

*   **确定上表面 $z(x, y)$**：
    立体的上顶由球面 $x^2 + y^2 + z^2 = R^2$ 决定。因为我们计算的是 $z \ge 0$ 的部分，所以上表面方程为 $z = \sqrt{R^2 - x^2 - y^2}$。

*   **确定积分区域 $D$**：
    积分区域 $D$ 是由圆柱面在 $xy$ 平面上的投影决定的，即圆 $(x - \frac{R}{2})^2 + y^2 \le (\frac{R}{2})^2$，或者写成 $x^2 + y^2 \le Rx$。

将这些代入，得到体积的二重积分表达式：
$$ V = 2 \iint_{x^2+y^2 \le Rx} \sqrt{R^2 - x^2 - y^2} \,dx\,dy $$

### 3. 坐标系变换与计算

由于积分区域 $D$ 是一个偏离原点的圆，并且被积函数中含有 $x^2+y^2$ 项，**使用极坐标是最佳选择**。

*   **极坐标变换**：
    令 $x = r\cos\theta$, $y = r\sin\theta$, 则 $dx\,dy = r\,dr\,d\theta$。
    被积函数变为 $\sqrt{R^2 - (r^2\cos^2\theta + r^2\sin^2\theta)} = \sqrt{R^2 - r^2}$。

*   **确定极坐标下的积分限**：
    这是最关键的一步。我们需要将积分区域 $D$ 的边界 $x^2 + y^2 = Rx$ 转换为极坐标形式。
    $(r\cos\theta)^2 + (r\sin\theta)^2 = R(r\cos\theta)$
    $r^2 = Rr\cos\theta$
    解得 $r = R\cos\theta$ (我们排除了 $r=0$ 这个平凡解，它代表原点)。
    这就是积分区域 $D$ 的边界在极坐标下的方程。

    *   **$\theta$ 的范围**：由于圆 $D$ 位于 $x \ge 0$ 的区域（因为 $x^2+y^2=Rx$ 且 $R>0$，所以 $x \ge 0$），$\theta$ 的范围是从 $-\frac{\pi}{2}$ 到 $\frac{\pi}{2}$。
    *   **$r$ 的范围**：对于每一个给定的 $\theta$，$r$ 从原点 $r=0$ 开始，延伸到边界 $r=R\cos\theta$。

*   **利用对称性简化积分限**：
    我们之前已经决定利用 $y \ge 0$ 的对称性。$y \ge 0$ 在极坐标中对应 $\theta$ 的范围是 $[0, \pi]$。结合上面 $\theta \in [-\frac{\pi}{2}, \frac{\pi}{2}]$，我们取交集得到 $\theta \in [0, \frac{\pi}{2}]$。
    因此，我们可以只在第一象限积分，然后将结果乘以 4。
    $$ V = 4 \int_{0}^{\pi/2} \int_{0}^{R\cos\theta} \sqrt{R^2 - r^2} \cdot r \,dr\,d\theta $$

### 4. 执行积分计算

**第一步：计算内层关于 $r$ 的积分**
$$ \int_{0}^{R\cos\theta} r\sqrt{R^2 - r^2} \,dr $$
这里使用换元法。令 $u = R^2 - r^2$，则 $du = -2r\,dr$，所以 $r\,dr = -\frac{1}{2}du$。
$$ \int \sqrt{u} (-\frac{1}{2}du) = -\frac{1}{2} \cdot \frac{u^{3/2}}{3/2} = -\frac{1}{3}(R^2 - r^2)^{3/2} $$
代入积分限：
$$ \left[ -\frac{1}{3}(R^2 - r^2)^{3/2} \right]_{0}^{R\cos\theta} = -\frac{1}{3} \left( (R^2 - R^2\cos^2\theta)^{3/2} - (R^2 - 0)^{3/2} \right) $$
$$ = -\frac{1}{3} \left( (R^2\sin^2\theta)^{3/2} - (R^2)^{3/2} \right) $$
因为 $\theta \in [0, \frac{\pi}{2}]$，$\sin\theta \ge 0$，所以 $(R^2\sin^2\theta)^{3/2} = (R\sin\theta)^3 = R^3\sin^3\theta$。
$$ = -\frac{1}{3} (R^3\sin^3\theta - R^3) = \frac{R^3}{3}(1 - \sin^3\theta) $$

**第二步：计算外层关于 $\theta$ 的积分**
$$ V = 4 \int_{0}^{\pi/2} \frac{R^3}{3}(1 - \sin^3\theta) \,d\theta = \frac{4R^3}{3} \int_{0}^{\pi/2} (1 - \sin^3\theta) \,d\theta $$
$$ = \frac{4R^3}{3} \left( \int_{0}^{\pi/2} 1 \,d\theta - \int_{0}^{\pi/2} \sin^3\theta \,d\theta \right) $$
*   $\int_{0}^{\pi/2} 1 \,d\theta = [\theta]_{0}^{\pi/2} = \frac{\pi}{2}$
*   $\int_{0}^{\pi/2} \sin^3\theta \,d\theta$ 可以使用华里士公式 $\int_{0}^{\pi/2} \sin^n\theta \,d\theta = \frac{(n-1)!!}{n!!}$ (当 n 为奇数时)。
    $$ \int_{0}^{\pi/2} \sin^3\theta \,d\theta = \frac{2}{3 \cdot 1} = \frac{2}{3} $$

**第三步：合并最终结果**
$$ V = \frac{4R^3}{3} \left( \frac{\pi}{2} - \frac{2}{3} \right) = 2R^3(\frac{\pi}{3} - \frac{4}{9}) = \frac{2R^3}{9}(3\pi - 4) $$


# 总结
这道题的完整思路是：
1.  **分析几何体**：识别球面和圆柱面。
2.  **利用对称性**：将问题简化为计算第一卦限体积的 4 倍。
3.  **建立积分**：用二重积分表达上半部分体积，确定被积函数（顶面）和积分区域（底面）。
4.  **坐标变换**：因积分区域和被积函数的形式，选择极坐标系进行计算。
5.  **确定积分限**：将积分区域的边界方程转换为极坐标形式，从而确定 $r$ 和 $\theta$ 的范围。
6.  **分步计算**：先对 $r$ 积分（使用换元法），再对 $\theta$ 积分（使用华里士公式），最终得出结果。